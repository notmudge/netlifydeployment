<!-- Sidebar profile block -->
<div class="sidebar-header" id="sidebar-profile">
  <img
    src="https://placehold.co/120x120?text=M"
    alt="Placeholder image for Mudge"
    class="sidebar-avatar">
  <h3 class="sidebar-name">Mudge</h3>
</div>

<script>
  (function () {
    // === 1. Move the profile header into place ===
    function placeHeader() {
      const header = document.getElementById('sidebar-profile');
      if (!header) return false;

      // Preferred: just above the tool icons row
      const tools = document.querySelector('.sidebar .sidebar-tools-main');
      if (tools && tools.parentNode) {
        tools.parentNode.insertBefore(header, tools);
        return true;
      }

      // Fallback: above the search box
      const search = document.querySelector('.sidebar .sidebar-search');
      if (search && search.parentNode) {
        search.parentNode.insertBefore(header, search);
        return true;
      }

      // Last resort: top of sidebar
      const container = document.querySelector(
        '.sidebar .sidebar-menu-container, .sidebar .sidebar-content, .sidebar'
      );
      if (container) {
        container.insertBefore(header, container.firstChild);
        return true;
      }
      return false;
    }

    // Run placement logic immediately or when sidebar appears
    if (!placeHeader()) {
      const mo = new MutationObserver(() => {
        if (placeHeader()) mo.disconnect();
      });
      mo.observe(document.body, { childList: true, subtree: true });
    }

    // === 2. Add dynamic terminal-style path to the sidebar ===
    document.addEventListener("DOMContentLoaded", () => {
      const sidebar = document.querySelector(".sidebar");
      if (!sidebar) return;

      // Extract the current path (strip extensions and trailing slashes)
      const path = window.location.pathname
        .replace(/\/index\.html$/, "/")
        .replace(/\.html$/, "")
        .replace(/\/$/, "")
        .split("/")
        .filter(Boolean)
        .join("/");

      // Format it like a shell path
      const displayPath = path ? `~/${path}` : "~";

      // Set it as an attribute for CSS to use
      sidebar.setAttribute("data-terminal-path", displayPath);
    });
  })();
</script>